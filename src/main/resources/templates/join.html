<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
		xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5" lang="en">

<head>
    <meta charset="utf-8">
    <title>회원가입</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="static/bootstrap/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="static/bootstrap/css/style.css" rel="stylesheet">
</head>

<body>

    <!-- Navbar Start -->
    <div class="container-fluid p-0">
        <nav class="navbar navbar-expand-lg bg-light navbar-light py-3 py-lg-0 px-lg-5">
            <a href="main" class="navbar-brand ml-lg-3">
                <h1 class="m-0 display-5 text-uppercase text-primary"><img src ="static/bootstrap/img/WDM.jpg" height="90" width="100">우동맛</h1>
            </a>
        </nav>
    </div> 
    <!-- Navbar End -->


    <!-- Header Start -->
    <div class="jumbotron jumbotron-fluid mb-5">
        <div class="container text-center py-5">
            <h1 class="text-white display-3">회원가입</h1>
            <div class="d-inline-flex align-items-center text-white">
                <p class="m-0"><a class="text-white" href="login">로그인</a></p>
                <i class="fa fa-circle px-3"></i>
                <p class="m-0"><a class="text-white" href="main">Home</a></p>
            </div>
        </div>
    </div>
    <!-- Header End -->


    <!-- Contact Start -->
    <div class="container-fluid py-5">
        <div class="container">
            <div class="row">
                </div>
                <div class="col-lg-7">
                    <h6 class="text-primary text-uppercase font-weight-bold">회원가입</h6>
                    <h1 class="mb-4">회원가입하기</h1>
                    <div class="contact-form bg-secondary" style="padding: 30px;">
                        <div id="success"></div>

                        <form name="join" id="join" method="post" action="/join">
                       
                            <div class="control-group">
                                <input type="text" class="form-control border-0 p-4" id="name" name="name" placeholder="이름을 입력해주세요"
                                    required="required" />                	
                                <p class="help-block text-danger"></p>
                
                            </div>
                            <div class="control-group">
                                <input type="text" class="form-control border-0 p-4" id="nickname" name="nickname" placeholder="별명을 입력해주세요."
                                    required oninput="checkNickname()"  />
                                <input type="hidden" class="btn btn-primary px-3" value="중복 검사" />
                                <span id="resultNickname"></span>
                                <p class="help-block text-danger"></p>
                            </div>
                            <div class="control-group">
                                <input type="text" class="form-control border-0 p-4" id="id" name="id" placeholder="ID를 입력해주세요"
                                    required oninput="checkId()"  />
                               	<input type="hidden" class="btn btn-primary px-3" value="중복 검사" />
                          		<span id="resultId"></span>
                                <p class="help-block text-danger"></p>
                            </div>
                            <div class="control-group">
                                <input type="password" class="form-control border-0 p-4" id="pwd" name="pwd" placeholder="비밀번호를 입력해주세요"
                                    required="required"/>
                                <p class="help-block text-danger"></p>
                            </div>
                            <div class="control-group">
                                <input type="password" class="form-control border-0 p-4" id="pwd_chk" name="pwd_chk" placeholder="비밀번호를 다시 확인해주세요"
                                    required="required" />
                                <p class="help-block text-danger"></p>
                            </div>                           
                            <div class="control-group">
                                <input type="email" class="form-control border-0 p-4" id="email" name="email" placeholder="Email을 입력해주세요"
                                  />
                                  
                               	<button class="btn btn-primary font-weight-semi-bold" id="checkEmail" name="checkEmail" type="button">인증하기</button>
                               	<input type="hidden" class="btn btn-primary px-3" value="중복 검사" />
                               	<span id="resultEmail"></span>
                                <p class="help-block text-danger"></p>
                                <!-- 이메일 인증 버튼 display:none -->
                                <div id="emailCfm" class="bg-secondary mb-3" style="display: none">
	                                <input type="text" class="form-control border-0" id="emailForm" name="emailForm">
		                     		<button class="btn btn-primary font-weight-semi-bold" id="authCheckEmail">인증</button>
		                     		<span id="resultAuthEmail"></span> 
                                </div>
                            </div>
                            <div class="control-group">
                                 <select name="gender" class="form-control border-0 p-4" size="1" >
                                 	<option value="3">선택안함</option>
                                 	<option value="2">여자</option>
				                    <option value="1">남자</option>			                  
				                   </select>
                                <p class="help-block text-danger"></p>
                            </div>
                             <div class="control-group">
                                <input type="text" class="form-control border-0 p-4" id="address" name="address" placeholder="주소를 입력해주세요"
                                    required="required"  />
                                <p class="help-block text-danger"></p>
                            </div>
                             <div class="control-group">
                                <input type="text" class="form-control border-0 p-4" id="address_detail" name="address_detail" placeholder="상세주소"
                                    required="required"  />
                                <p class="help-block text-danger"></p>
                            </div>                                              
                             <div class="control-group">
                                <input type="text" class="form-control border-0 p-4" id="phone" name="phone" placeholder="010-0000-0000"
                                    required="required"  />
                                <p class="help-block text-danger"></p>
                            </div>  
                            <div>
                                <button class="btn btn-primary py-3 px-4" onclick="return checkJoin()" type="submit" id="sendButton" disabled="disabled">회원가입</button>
                            </div>
                        </form>
                        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                        <script type="text/javascript">
							$(document).ready(function(){

							$("#checkEmail").click(function(){
								$("#emailCfm").css("display", "block");
								$.ajax({
						            url:'/mail', 
						            type:'post', 
						            data:{"email":$("#email").val()},
						            dataType:"json",
						            success:function(data){			            	
						            }
							    	})
								})
							
					        $("#authCheckEmail").click(function(){
					        	$.ajax({
					        		url:'/authCheckEmail',
					        		type:'get',
					        		data:{"authKey":$("#emailForm").val(),
					        			"email":$("#email").val()},
					        		dataType:"json",
					        		success:function(result){
					        			console.log("성공");
					        			if(result == '1'){

					        				alert("인증 성공");
											$(".btn").removeAttr("disabled");
							            }else{

							            	alert("인증 실패");
											$(".btn").attr("disabled", "disabled");
										}
					        		}
					        	});
					        });
                        });
                        
                        
                        
                        
                        function checkNickname(){
					        var nickname = $('#nickname').val();
					        $.ajax({
					            url:'/nicknameCheck', 
					            type:'post', 
					            data:{nickname:nickname},
					            success:function(cnt){
									if(cnt == '0'){
										$('#resultNickname').text('사용 가능한 닉네임입니다.').css("color", "#757575");
										$(".btn").removeAttr("disabled");
						            }else{
										$('#resultNickname').text('이미 사용중인 닉네임입니다.').css("color", "red");
										$(".btn").attr("disabled", "disabled");
									}if(nickname ==""){
										$('#resultNickname').text('');
										$(".btn").attr("disabled", "disabled");
									}
					                
						        },
						        error:function(){
						            alert("에러입니다");
						        }
						    });
						};
								
						function checkId(){
					        var id = $('#id').val();
					        $.ajax({
					            url:'/idCheck', 
					            type:'post', 
					            data:{id:id},
					            success:function(cnt){
									if(cnt == '0'){
										$('#resultId').text('사용 가능한 아이디입니다.').css("color", "#757575");
										$(".btn").removeAttr("disabled");
						            }else{
										$('#resultId').text('이미 사용중인 아이디입니다.').css("color", "red");
										$(".btn").attr("disabled", "disabled");
						            }if(id ==""){
										$('#resultId').text('');
										$(".btn").attr("disabled", "disabled");
									}
					                
						        },
						        error:function(){
						            alert("에러입니다");
						        }
						    });
						};
								
/*  						function checkEmail(){
					        var email = $('#email').val();
					        $.ajax({
					            url:'/emailCheck', 
					            type:'post', 
					            data:{email:email},
					            success:function(cnt){
									if(cnt == '0'){
										$('#resultEmail').text('사용 가능한 이메일입니다.').css("color", "#757575");
										$(".btn").removeAttr("disabled");
						            }else{
										$('#resultEmail').text('이미 사용중인 이메일입니다.').css("color", "red");
										$(".btn").attr("disabled", "disabled");
									}if(email ==""){
										$('#resultEmail').text('');
										$(".btn").attr("disabled", "disabled");
									}
					                
						        },
						        error:function(){
						            alert("에러입니다");
						        }
						    });
						};
 */
								/* 유효성 검사  */
								function checkJoin(){
									var name = document.getElementById("name");
									var nickname = document.getElementById("nickname");
									var id = document.getElementById("id");
									var pwd = document.getElementById("pwd");
									var pwd_chk = document.getElementById("pwd_chk");
									var email = document.getElementById("email");
									var phone = document.getElementById("phone");
									
									/* 정규식 */
									var nameCheck = /^[가-힣]+$/;		/* 한글만 가능 */
									var nicknameCheck = /^([a-zA-Z0-9ㄱ-ㅎ|ㅏ-ㅣ|가-힣]).{1,20}$/;		/* 한글, 영문, 숫자만 2~20 자리 가능*/	
									var idCheck = /^[A-Za-z]{1}[A-Za-z0-9_-]{3,20}$/;		/* 영문 시작 숫자 , 언더바/하이픈 허용 4~20자리 */
									var pwdCheck = /^.*(?=^.{8,20}$)(?=.*\d)(?=.*[a-zA-Z])(?=.*[!@#$%^&+=]).*$/;	/* 특수문자, 문자, 숫자 포함 형태의  8~20 자리 */
									var emailCheck = /^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/;		/* 이메일 형식 */ 
									var phoneCheck = /^01(?:0|1|[6-9])-(?:\d{3}|\d{4})-\d{4}$/;	/* 핸드폰 번호 형식 */
									
									/* 이름 유효성 검사 */
									if(name.value == "" || !nameCheck.test(name.value)){
										alert("이름은 한글만 입력 가능합니다.");

										name.focus();
										return false;
									};
							
									if(nickname.value == "" || !nicknameCheck.test(nickname.value)){
										alert("닉네임은 한글, 영문, 숫자 포함 2~20 자리 가능합니다.");
										nickname.focus();
										return false;
									};
									
									if(id.value == "" || !idCheck.test(id.value)){
										alert("아이디는 영문 시작 + 숫자, 언더바/하이픈 4~20자리 가능합니다.");
										id.focus();
										return false;
									};
									
									if(pwd.value == "" || !pwdCheck.test(pwd.value)){
										alert("비밀번호는 특수문자, 문자, 숫자 포함 8~20 자리 가능합니다.");
										
										pwd.focus();
										return false;
									};
									
									if(pwd_chk.value !== pwd.value){
										alert("비밀번호가 일치하지 않습니다.");
										pwd_chk.focus();
										return false;
									};
									
									if(email.value == "" || !emailCheck.test(email.value)){
										alert("이메일 형식으로 입력해주세요");
										email.focus();
										return false;
									};
									
									if(phone.value == "" || !phoneCheck.test(phone.value)){
										alert("핸드폰 번호 형식으로 입력해주세요.");
										phone.focus();
										return false;
									};
									
									alert("회원가입 성공");
									return true;
								}
								
								
								function emailCfm(){
									
								}
    
								</script>
                    </div>
                </div>
            </div>
        </div>
	<!-- 카카오 도로명 주소 -->
	<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
		<script>
		window.onload = function(){
		    document.getElementById("address").addEventListener("click", function(){ //주소입력칸을 클릭하면
		        //카카오 지도 발생
		        new daum.Postcode({
		            oncomplete: function(data) { //선택시 입력값 세팅
		                document.getElementById("address").value = data.address; // 주소 넣기
		                document.querySelector("input[id=address_detail]").focus(); //상세입력 포커싱
		            }
		        }).open();
		    });
		}
		</script>
    <!-- Contact End -->


    <!-- Footer Start -->

    <th:block th:replace="~{footer :: footer1}"></th:block>
    <!-- Footer End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="static/bootstrap/lib/easing/easing.min.js"></script>
    <script src="static/bootstrap/lib/waypoints/waypoints.min.js"></script>
    <script src="static/bootstrap/lib/counterup/counterup.min.js"></script>
    <script src="static/bootstrap/lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="static/bootstrap/mail/jqBootstrapValidation.min.js"></script>
    <script src="static/bootstrap/mail/contact.js"></script>

    <!-- Template Javascript -->
    <script src="static/bootstrap/js/main.js"></script>
</body>

</html>